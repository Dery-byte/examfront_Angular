<div class="app-shell">

  <!-- ══ TOPBAR ══════════════════════════════════════════════ -->
  <header class="topbar">

    <div class="topbar-left">
      <!-- Hamburger toggle -->
      <button class="menu-toggle" [class.open]="!sidebarOpen" (click)="toggleSidebar()" aria-label="Toggle navigation">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <!-- Logo -->
      <a routerLink="/user-dashboard/0" class="topbar-logo">
        <div class="logo-tile"><span>OTC</span></div>
        <span class="logo-wordmark">Platform</span>
      </a>
    </div>

    <!-- Breadcrumb -->
    <div class="topbar-center">
      <span class="breadcrumb-item">OTC</span>
      <span class="breadcrumb-sep">/</span>
      <span class="breadcrumb-item current">Dashboard</span>
    </div>

    <div class="topbar-right">

      <!-- Session timer -->
      <div class="session-pill">
        <div class="session-dot" [ngClass]="timeLeftDisplay?.className"></div>
        <span class="session-text">Session</span>
        <span class="session-time">{{ timeDisplay?.display }}</span>
      </div>

      <!-- User chip -->
      <div class="user-chip">
        <div class="user-avatar">
          <span>{{ user.username | slice:0:2 | uppercase }}</span>
        </div>
        <span class="user-name-text">{{ user.username | uppercase }}</span>
        <span class="user-chevron">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </span>
      </div>

    </div>
  </header>

  <!-- ══ BODY ══════════════════════════════════════════════════ -->
  <div class="app-body">

    <!-- Mobile overlay -->
    <div class="sidebar-overlay" [class.show]="mobileOpen" (click)="toggleSidebar()"></div>

    <!-- ══ SIDEBAR ════════════════════════════════════════════ -->
    <nav class="sidebar"
         [class.collapsed]="!sidebarOpen && !isMobile"
         [class.mobile-open]="mobileOpen">

      <div class="sidebar-header">
        <div class="sidebar-user-row">
          <div class="sidebar-avatar">
            <span>{{ user.username | slice:0:2 | uppercase }}</span>
          </div>
          <div class="sidebar-user-info">
            <div class="sidebar-username">{{ user.username | uppercase }}</div>
            <div class="sidebar-role">Student</div>
          </div>
        </div>
      </div>

      <div class="sidebar-nav">
        <div class="nav-section-label">Main</div>

        <a class="nav-item"
           routerLink="/user-dashboard/0"
           routerLinkActive="active"
           (click)="closeDrawerOnMobile()">
          <span class="nav-icon">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
          </span>
          Home
        </a>

        <a class="nav-item"
           routerLink="/user-dashboard/register"
           routerLinkActive="active"
           (click)="closeDrawerOnMobile()">
          <span class="nav-icon">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
            </svg>
          </span>
          Register Courses
        </a>

        <a class="nav-item"
           routerLink="/user-dashboard/courses"
           routerLinkActive="active"
           (click)="closeDrawerOnMobile()">
          <span class="nav-icon">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7" rx="1"/>
              <rect x="14" y="3" width="7" height="7" rx="1"/>
              <rect x="3" y="14" width="7" height="7" rx="1"/>
              <rect x="14" y="14" width="7" height="7" rx="1"/>
            </svg>
          </span>
          My Courses
        </a>

        <a class="nav-item"
           routerLink="/user-dashboard/quizzes"
           routerLinkActive="active"
           (click)="closeDrawerOnMobile()">
          <span class="nav-icon">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
          </span>
          Available Quizzes
        </a>

        <div class="sidebar-divider"></div>
        <div class="nav-section-label">Account</div>

        <a class="nav-item logout" (click)="logout(); closeDrawerOnMobile()">
          <span class="nav-icon">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
          </span>
          Logout
        </a>
      </div>

      <div class="sidebar-footer">
        <span class="sidebar-version">OTC PLATFORM v2.5</span>
      </div>

    </nav>

    <!-- ══ ROUTER OUTLET ════════════════════════════════════ -->
    <main class="main-content" [class.expanded]="!sidebarOpen && !isMobile">
      <router-outlet></router-outlet>
    </main>

  </div><!-- /app-body -->
</div><!-- /app-shell -->