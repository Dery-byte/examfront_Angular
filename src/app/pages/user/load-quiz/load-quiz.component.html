<mat-card class="quiz-summary-card">
  <!-- Loading indicator for initial report data -->

  <div *ngIf="isLoadingReports" class="loading-container">
    <button mat-raised-button color="accent" class="loading-button">
      <div class="button-content">
        <span>Loading Courses ...</span>
      </div>
    </button>
  </div>







  <!-- Main content when reports are loaded -->
  <div *ngIf="!isLoadingReports">
    <div *ngIf="reports.length > 0; else noQuizzesBlock">
      <h4 class="section-title">Quiz Taken Summary</h4>
      <div class="container">
        <div class="row">
          <!-- Course selection column -->
          <div class="col-md-2 course-selection">
            <form>
              <mat-form-field appearance="fill">
                <mat-label>Select Course</mat-label>
                <mat-select name="category" [(ngModel)]="categories.cid" (selectionChange)="onQuizOptionSelected()">
                  <mat-option *ngFor="let c of reports" [value]="c.quiz.category.cid">
                    {{c.quiz.category.title}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </form>
          </div>
          <!-- Quizzes display column -->
          <div class="col-md-9 offset-md-1 quizzes-display">


            <div *ngIf="isLoadingQuizzes" class="loading-container">
              <button mat-raised-button color="primary" class="loading-button">
                <div class="button-content">
                  <mat-spinner diameter="30" class="loading-spinner"></mat-spinner>

                  <span>Loading Quiz(s) ...</span>
                </div>
              </button>
            </div>

            <!-- Loading indicator for quizzes -->
            <!-- Quizzes list -->
            <div class="row quiz-list" *ngIf="availablequizzes && !isLoadingQuizzes">
              <!-- Quiz cards -->
              <div class="col-md-6 quiz-card" *ngFor="let q of availablequizzes">
                <mat-card>
                  <mat-card-header>
                    <div mat-card-avatar class="quiz-avatar"></div>
                    <mat-card-title>{{q.title}}</mat-card-title>
                    <mat-card-subtitle>
                      {{q.category.courseCode}} | {{q.category.title}}
                    </mat-card-subtitle>
                  </mat-card-header>
                  <mat-card-content>
                    <p class="quiz-description">{{q.description}}</p>
                  </mat-card-content>
                  <mat-card-actions>
                    <button mat-button color="primary" matTooltip="Summary Results" aria-label="View summary"
                      (click)="openNew(q.qId)">
                      View Summary
                    </button>

                    <!-- {{q|json}} -->

                    <button mat-button color="accent" (click)="onPrintClick($event, q.qId)"
                      [disabled]="q.status !== 'CLOSED'" [class.disabled-button]="q.status !== 'CLOSED'">
                      Print Results
                    </button>

                    <!-- Conditional message -->
                    <div *ngIf="q.status !== 'CLOSED'" class="print-warning">
                      <mat-icon color="warn">lock</mat-icon>
                      Print available after quiz closure.
                    </div>







                  </mat-card-actions>
                </mat-card>
              </div>
              <!-- Empty state -->
              <div class="col-md-12 empty-state" *ngIf="availablequizzes.length === 0">
                <h1>Select quiz to print or view summary</h1>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- No quizzes taken block -->
  <ng-template #noQuizzesBlock>
    <h1 class="no-quizzes-message">You have not taken any quiz yet.</h1>
  </ng-template>
</mat-card>
<!-- Quiz summary dialog -->
<p-dialog [(visible)]="productDialog" [style]="{width: '300px', height: '550px'}" class="quiz-dialog"
  header="Quiz Summary">
  <mat-card *ngIf="reportData">
    <table class="summary-table">
      <tr>
        <th>Objective</th>
        <th>Theory</th>
        <th>Status</th>
      </tr>
      <tr *ngFor="let r of reportData">
        <td>{{r.marks}}</td>
        <td>{{r.marksB}}</td>
        <td>{{r.progress}}</td>
      </tr>
    </table>
    <div class="no-results" *ngIf="reports.length === 0">
      <h1>No results available. Please take a quiz first.</h1>
    </div>
  </mat-card>
</p-dialog>











<script>
  if (document.getElementById("typed")) {
    var typed = new Typed("#typed", {
      stringsElement: "#typed-strings",
      typeSpeed: 70,
      backSpeed: 50,
      backDelay: 200,
      startDelay: 500,
      loop: true
    });
  }
</script>